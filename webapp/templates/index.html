<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8">
  <title>Ph√¢n T√≠ch Th√≥i Quen Ti√™u Th·ª• Th·ª±c Ph·∫©m</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', Arial, sans-serif;
      background: linear-gradient(120deg, #d4f1f9, #f0f5ff);
      color: #023047;
    }
    header {
      background: rgba(255,255,255,0.7);
      backdrop-filter: blur(8px);
      box-shadow: 0 1px 10px rgba(0,0,0,0.05);
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 40px;
      position: sticky;
      top: 0;
    }
    header h1 {
      font-size: 22px;
      color: #046b8c;
      font-weight: 600;
    }
    .btn-primary {
      background: linear-gradient(90deg, #00b4d8, #0077b6);
      color: #fff;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      transition: 0.3s;
    }
    .btn-primary:hover {
      background: linear-gradient(90deg, #0096c7, #005f73);
    }
    .container {
      max-width: 1100px;
      margin: 50px auto;
      display: flex;
      gap: 40px;
      align-items: flex-start;
    }
    .left {
      flex: 1.3;
      background: #ffffffb8;
      border-radius: 20px;
      padding: 30px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }
    .right {
      flex: 0.8;
      background: rgba(255,255,255,0.8);
      border-radius: 20px;
      padding: 25px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    }
    textarea {
      width: 100%;
      height: 100px;
      border-radius: 10px;
      border: 1px solid #aadcec;
      padding: 10px;
      resize: none;
      font-size: 15px;
    }
    #warnings {
      margin-top: 15px;
      color: #d62828;
      font-weight: 600;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      margin-top: 15px;
      background: #fff;
      border-radius: 10px;
      overflow: hidden;
    }
    th, td {
      border: 1px solid #e0f2f1;
      padding: 8px;
      text-align: center;
    }
    th {
      background: #caf0f8;
      color: #023e8a;
    }
    canvas {
      margin-top: 20px;
    }
  </style>
</head>
<body>

<header>
  <h1>üçé Health Predict Vi·ªát Nam</h1>
  <button class="btn-primary" onclick="scrollToInput()">Ph√¢n t√≠ch ngay</button>
</header>

<div class="container">
  <div class="left">
    <h2>Ph√¢n t√≠ch th√≥i quen ti√™u th·ª• th·ª±c ph·∫©m</h2>
    <p>Nh·∫≠p: ‚ÄúT√¥i ƒÉn 200g c∆°m, 150g th·ªãt g√†, 1 ly tr√† s·ªØa‚Äù</p>

    <textarea id="user_text" placeholder="Nh·∫≠p th√≥i quen ƒÉn u·ªëng c·ªßa b·∫°n..."></textarea><br>
    <button class="btn-primary" onclick="analyze()">Ph√¢n t√≠ch</button>

    <div id="warnings"></div>
    <canvas id="riskChart"></canvas>
  </div>

  <div class="right">
    <h3>üìä T·ªâ l·ªá m·∫Øc b·ªánh theo nh√≥m tu·ªïi (WHO Vi·ªát Nam)</h3>
    <table>
      <thead>
        <tr><th>Nh√≥m tu·ªïi</th><th>Ti·ªÉu ƒë∆∞·ªùng (%)</th><th>B√©o ph√¨ (%)</th><th>Tim m·∫°ch (%)</th></tr>
      </thead>
      <tbody>
        <tr><td>18‚Äì29</td><td>5.3</td><td>8.1</td><td>4.5</td></tr>
        <tr><td>30‚Äì44</td><td>8.7</td><td>15.2</td><td>7.1</td></tr>
        <tr><td>45‚Äì59</td><td>13.4</td><td>23.8</td><td>12.5</td></tr>
        <tr><td>60+</td><td>18.9</td><td>28.6</td><td>21.3</td></tr>
      </tbody>
    </table>
  </div>
</div>

<script>
function scrollToInput(){ document.querySelector('.left').scrollIntoView({behavior:'smooth'}); }

function analyze(){
  const text = document.getElementById('user_text').value;
  fetch('/analyze_text', {
    method: 'POST',
    headers: {'Content-Type':'application/json'},
    body: JSON.stringify({text})
  })
  .then(r=>r.json())
  .then(data=>{
    document.getElementById('warnings').innerHTML =
      data.warnings.join('<br>') || '‚úÖ Kh√¥ng c√≥ c·∫£nh b√°o dinh d∆∞·ª°ng.';
    const ctx = document.getElementById('riskChart').getContext('2d');
    const labels = ['Ti·ªÉu ƒë∆∞·ªùng','B√©o ph√¨','Tim m·∫°ch'];
    const values = [data.risks.diabetes, data.risks.obesity, data.risks.cardio];
    if(window.riskChart) window.riskChart.destroy();
    window.riskChart = new Chart(ctx,{
      type:'bar',
      data:{
        labels:labels,
        datasets:[{
          label:'Nguy c∆° (%)',
          data:values,
          backgroundColor:'#0096c7'
        }]
      },
      options:{
        scales:{y:{beginAtZero:true,max:100}},
        plugins:{legend:{display:false}}
      }
    });
  });
}
</script>

</body>
</html>
